!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Protyle=t():e.Protyle=t()}(self,(()=>(()=>{"use strict";var e={378:(e,t,n)=>{n.r(t)},450:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;class n{}t.Constants=n,n.SIYUAN_VERSION="2.5.2",n.NODE_ENV="production",n.SIYUAN_APPID=Math.random().toString(36).substring(8),n.ASSETS_ADDRESS="https://assets.b3logfile.com/siyuan/",n.PROTYLE_CDN="/stage/protyle",n.UPLOAD_ADDRESS="/upload",n.SIYUAN_DROP_FILE="application/siyuan-file",n.SIYUAN_DROP_TAB="application/siyuan-tab",n.SIYUAN_DROP_EDITOR="application/siyuan-editor",n.SIYUAN_CONFIG_THEME="siyuan-config-theme",n.SIYUAN_CONFIG_CLOSE="siyuan-config-close",n.SIYUAN_CONFIG_TRAY="siyuan-config-tray",n.SIYUAN_CONFIG_CLOSETRAY="siyuan-config-closetray",n.SIYUAN_QUIT="siyuan-quit",n.SIYUAN_HOTKEY="siyuan-hotkey",n.SIYUAN_INIT="siyuan-init",n.SIYUAN_OPENURL="siyuan-openurl",n.SIYUAN_SAVE_CLOSE="siyuan-save-close",n.SIYUAN_EXPORT_PDF="siyuan-export-pdf",n.SIYUAN_EXPORT_CLOSE="siyuan-export-close",n.SIZE_TOOLBAR_HEIGHT=42,n.SIZE_GET_MAX=102400,n.SIZE_UNDO=64,n.SIZE_TITLE=512,n.SIZE_EDITOR_WIDTH=760,n.CB_MOUNT_HELP="cb-mount-help",n.CB_MOUNT_REMOVE="cb-mount-remove",n.CB_GET_APPEND="cb-get-append",n.CB_GET_BEFORE="cb-get-before",n.CB_GET_UNCHANGEID="cb-get-unchangeid",n.CB_GET_HL="cb-get-hl",n.CB_GET_FOCUS="cb-get-focus",n.CB_GET_FOCUSFIRST="cb-get-focusfirst",n.CB_GET_SETID="cb-get-setid",n.CB_GET_ALL="cb-get-all",n.CB_GET_UNUNDO="cb-get-unundo",n.CB_GET_SCROLL="cb-get-scroll",n.CB_GET_CONTEXT="cb-get-context",n.CB_GET_HTML="cb-get-html",n.CB_GET_HISTORY="cb-get-history",n.LOCAL_SEARCHEDATA="local-searchedata",n.LOCAL_DOCINFO="local-docinfo",n.LOCAL_DAILYNOTEID="local-dailynoteid",n.LOCAL_HISTORYNOTEID="local-historynoteid",n.LOCAL_CODELANG="local-codelang",n.LOCAL_FONTSTYLES="local-fontstyles",n.LOCAL_EXPORTPDF="local-exportpdf",n.LOCAL_EXPORTWORD="local-exportword",n.LOCAL_BAZAAR="local-bazaar",n.LOCAL_PDFTHEME="local-pdftheme",n.TIMEOUT_DBLCLICK=190,n.TIMEOUT_SEARCH=300,n.TIMEOUT_INPUT=256,n.TIMEOUT_BLOCKLOAD=300,n.TIMEOUT_TRANSITION=150,n.HELP_PATH={zh_CN:"20210808180117-czj9bvb",zh_CHT:"20211226090932-5lcq56f",en_US:"20210808180117-6v0mkxr",fr_FR:"20210808180117-6v0mkxr"},n.HELP_START_PATH={zh_CN:"20200812220555-lj3enxa",zh_CHT:"20211226115423-d5z1joq",en_US:"20200923234011-ieuun1p",fr_FR:"20200923234011-ieuun1p"},n.KEYCODE={186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']},n.SIYUAN_KEYMAP={general:{editMode:{default:"‚áß‚åòG",custom:"‚áß‚åòG"},syncNow:{default:"F9",custom:"F9"},enterBack:{default:"‚å•‚Üê",custom:"‚å•‚Üê"},enter:{default:"‚å•‚Üí",custom:"‚å•‚Üí"},goForward:{default:"‚åò]",custom:"‚åò]"},goBack:{default:"‚åò[",custom:"‚åò["},newFile:{default:"‚åòN",custom:"‚åòN"},search:{default:"‚åòF",custom:"‚åòF"},globalSearch:{default:"‚åòP",custom:"‚åòP"},stickSearch:{default:"‚áß‚åòF",custom:"‚áß‚åòF"},replace:{default:"‚åòR",custom:"‚åòR"},closeTab:{default:"‚åòW",custom:"‚åòW"},fileTree:{default:"‚å•1",custom:"‚å•1"},outline:{default:"‚å•2",custom:"‚å•2"},bookmark:{default:"‚å•3",custom:"‚å•3"},tag:{default:"‚å•4",custom:"‚å•4"},dailyNote:{default:"‚å•5",custom:"‚å•5"},inbox:{default:"‚å•6",custom:"‚å•6"},backlinks:{default:"‚å•7",custom:"‚å•7"},graphView:{default:"‚å•8",custom:"‚å•8"},globalGraph:{default:"‚å•9",custom:"‚å•9"},config:{default:"‚å•P",custom:"‚å•P"},dataHistory:{default:"‚å•H",custom:"‚å•H"},toggleWin:{default:"‚å•M",custom:"‚å•M"},lockScreen:{default:"‚å•N",custom:"‚å•N"},move:{default:"",custom:""},selectOpen1:{default:"",custom:""}},editor:{general:{duplicate:{default:"‚åòD",custom:"‚åòD"},expandDown:{default:"‚å•‚áß‚Üì",custom:"‚å•‚áß‚Üì"},expandUp:{default:"‚å•‚áß‚Üë",custom:"‚å•‚áß‚Üë"},copyPlainText:{default:"",custom:""},copyID:{default:"",custom:""},netImg2LocalAsset:{default:"",custom:""},hLayout:{default:"",custom:""},vLayout:{default:"",custom:""},refPopover:{default:"",custom:""},expand:{default:"‚åò‚Üì",custom:"‚åò‚Üì"},collapse:{default:"‚åò‚Üë",custom:"‚åò‚Üë"},insertBottom:{default:"‚å•‚åò.",custom:"‚å•‚åò."},refTab:{default:"‚áß‚åò>",custom:"‚áß‚åò>"},openBy:{default:"‚å•,",custom:"‚å•,"},insertRight:{default:"‚å•.",custom:"‚å•."},attr:{default:"‚å•‚åòA",custom:"‚å•‚åòA"},refresh:{default:"F5",custom:"F5"},copyBlockRef:{default:"‚áß‚åòC",custom:"‚áß‚åòC"},copyProtocol:{default:"‚áß‚åòH",custom:"‚áß‚åòH"},copyBlockEmbed:{default:"‚áß‚åòE",custom:"‚áß‚åòE"},copyHPath:{default:"‚áß‚åòP",custom:"‚áß‚åòP"},undo:{default:"‚åòZ",custom:"‚åòZ"},redo:{default:"‚åòY",custom:"‚åòY"},rename:{default:"F2",custom:"F2"},newNameFile:{default:"F3",custom:"F3"},newContentFile:{default:"F4",custom:"F4"},showInFolder:{default:"‚å•A",custom:"‚å•A"},outline:{default:"‚å•O",custom:"‚å•O"},backlinks:{default:"‚å•B",custom:"‚å•B"},graphView:{default:"‚å•G",custom:"‚å•G"},fullscreen:{default:"‚å•Y",custom:"‚å•Y"},alignLeft:{default:"‚å•L",custom:"‚å•L"},alignCenter:{default:"‚å•C",custom:"‚å•C"},alignRight:{default:"‚å•R",custom:"‚å•R"},wysiwyg:{default:"‚å•‚åò7",custom:"‚å•‚åò7"},preview:{default:"‚å•‚åò9",custom:"‚å•‚åò9"},insertBefore:{default:"‚áß‚åòB",custom:"‚áß‚åòB"},insertAfter:{default:"‚áß‚åòA",custom:"‚áß‚åòA"},jumpToParentNext:{default:"‚áß‚åòN",custom:"‚áß‚åòN"},moveToUp:{default:"‚áß‚åò‚Üë",custom:"‚áß‚åò‚Üë"},moveToDown:{default:"‚áß‚åò‚Üì",custom:"‚áß‚åò‚Üì"}},insert:{font:{default:"‚å•‚åòX",custom:"‚å•‚åòX"},lastUsed:{default:"‚å•X",custom:"‚å•X"},blockRef:{default:"‚å•[",custom:"‚å•["},kbd:{default:"‚åò'",custom:"‚åò'"},sup:{default:"‚åòH",custom:"‚åòH"},sub:{default:"‚åòJ",custom:"‚åòJ"},bold:{default:"‚åòB",custom:"‚åòB"},"inline-math":{default:"‚åòM",custom:"‚åòM"},memo:{default:"‚å•‚åòM",custom:"‚å•‚åòM"},underline:{default:"‚åòU",custom:"‚åòU"},italic:{default:"‚åòI",custom:"‚åòI"},mark:{default:"‚åòE",custom:"‚åòE"},tag:{default:"‚åòT",custom:"‚åòT"},strike:{default:"‚áß‚åòS",custom:"‚áß‚åòS"},"inline-code":{default:"‚åòG",custom:"‚åòG"},link:{default:"‚åòK",custom:"‚åòK"},check:{default:"‚åòL",custom:"‚åòL"},table:{default:"‚åòO",custom:"‚åòO"},code:{default:"‚áß‚åòK",custom:"‚áß‚åòK"},clearFontStyle:{default:"‚åò\\",custom:"‚åò\\"}},heading:{paragraph:{default:"‚å•‚åò0",custom:"‚å•‚åò0"},heading1:{default:"‚å•‚åò1",custom:"‚å•‚åò1"},heading2:{default:"‚å•‚åò2",custom:"‚å•‚åò2"},heading3:{default:"‚å•‚åò3",custom:"‚å•‚åò3"},heading4:{default:"‚å•‚åò4",custom:"‚å•‚åò4"},heading5:{default:"‚å•‚åò5",custom:"‚å•‚åò5"},heading6:{default:"‚å•‚åò6",custom:"‚å•‚åò6"}},list:{indent:{default:"‚á•",custom:"‚á•"},outdent:{default:"‚áß‚á•",custom:"‚áß‚á•"},checkToggle:{default:"‚åò‚Ü©",custom:"‚åò‚Ü©"}},table:{insertRowAbove:{default:"‚áß‚åòT",custom:"‚áß‚åòT"},insertRowBelow:{default:"‚áß‚åòD",custom:"‚áß‚åòD"},insertColumnLeft:{default:"‚áß‚åòL",custom:"‚áß‚åòL"},insertColumnRight:{default:"‚áß‚åòR",custom:"‚áß‚åòR"},moveToUp:{default:"‚å•‚åòT",custom:"‚å•‚åòT"},moveToDown:{default:"‚å•‚åòB",custom:"‚å•‚åòB"},moveToLeft:{default:"‚å•‚åòL",custom:"‚å•‚åòL"},moveToRight:{default:"‚å•‚åòR",custom:"‚å•‚åòR"},"delete-row":{default:"‚åò-",custom:"‚åò-"},"delete-column":{default:"‚áß‚åò_",custom:"‚áß‚åò_"}}}},n.SIYUAN_EMPTY_LAYOUT={hideDock:!1,layout:{direction:"tb",size:"0px",type:"normal",instance:"Layout",children:[{direction:"lr",size:"0px",type:"top",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"lr",children:[]}]},{direction:"lr",resize:"tb",size:"auto",type:"normal",instance:"Layout",children:[{direction:"tb",size:"0px",type:"left",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"tb",children:[]}]},{direction:"lr",resize:"lr",size:"auto",type:"center",instance:"Layout",children:[{instance:"Wnd",children:[{instance:"Tab",children:[]}]}]},{direction:"tb",size:"0px",resize:"lr",type:"right",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"tb",children:[]}]}]},{direction:"lr",size:"0px",resize:"tb",type:"bottom",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"lr",children:[]}]}]},top:[],bottom:[],left:[[{type:"file",size:{width:240,height:0},show:!0,icon:"iconFiles",hotkeyLangId:"fileTree"},{type:"outline",size:{width:240,height:0},show:!1,icon:"iconAlignCenter",hotkeyLangId:"outline"},{type:"inbox",size:{width:252,height:0},show:!1,icon:"iconInbox",hotkeyLangId:"inbox"}],[{type:"bookmark",size:{width:240,height:0},show:!1,icon:"iconBookmark",hotkeyLangId:"bookmark"},{type:"tag",size:{width:240,height:0},show:!1,icon:"iconTags",hotkeyLangId:"tag"}]],right:[[{type:"graph",size:{width:360,height:0},show:!1,icon:"iconGraph",hotkeyLangId:"graphView"},{type:"globalGraph",size:{width:360,height:0},show:!1,icon:"iconGlobalGraph",hotkeyLangId:"globalGraph"}],[{type:"backlink",size:{width:360,height:0},show:!1,icon:"iconLink",hotkeyLangId:"backlinks"}]]},n.SIYUAN_IMAGE_VIP='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">\n<path fill="#ffd00f" d="M2.288 12.643l23.487 12.853c0.286 0.153 0.477 0.45 0.477 0.791 0 0.082-0.011 0.161-0.032 0.237l0.001-0.006c-0.119 0.395-0.479 0.678-0.905 0.678-0.004 0-0.009-0-0.013-0h-19.439c-0.958 0-1.766-0.684-1.885-1.595l-1.691-12.956z"></path>\n<path fill="#ffd00f" d="M29.676 12.643l-1.691 12.957c-0.119 0.911-0.927 1.594-1.884 1.594h-19.442c-0.004 0-0.009 0-0.013 0-0.425 0-0.785-0.281-0.903-0.668l-0.002-0.007c-0.019-0.070-0.031-0.15-0.031-0.232 0-0.341 0.191-0.638 0.472-0.788l0.005-0.002 23.487-12.853z"></path>\n<path fill="#ffe668" d="M15.413 8.369l10.394 15.921c0.378 0.579 0.407 1.317 0.076 1.924-0.328 0.591-0.948 0.985-1.66 0.985-0 0-0.001 0-0.001 0h-17.617c-0.694 0-1.331-0.378-1.661-0.985-0.144-0.26-0.229-0.569-0.229-0.899 0-0.382 0.114-0.736 0.31-1.033l-0.004 0.007 10.394-15.921z"></path>\n<path fill="#ffdd4e" d="M15.396 8.403l11.659 15.921c0.401 0.579 0.432 1.317 0.081 1.924-0.361 0.594-1.005 0.985-1.741 0.985-0.008 0-0.017-0-0.025-0h-9.344l-0.63-18.83z"></path>\n<path fill="#ffd00f" d="M13.868 6.478c0 0.946 0.767 1.712 1.712 1.712s1.712-0.767 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0zM28.577 10.818c0 0.945 0.766 1.712 1.712 1.712s1.712-0.766 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0zM0 10.822c0 0.945 0.766 1.712 1.712 1.712s1.712-0.766 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0z"></path>\n</svg>',n.SIYUAN_IMAGE_FILE="1f4c4",n.SIYUAN_IMAGE_NOTE="1f5c3",n.SIYUAN_IMAGE_FOLDER="1f4d1",n.SIYUAN_ASSETS_IMAGE=[".apng",".ico",".cur",".jpg",".jpe",".jpeg",".jfif",".pjp",".pjpeg",".png",".gif",".webp",".bmp",".svg"],n.SIYUAN_ASSETS_AUDIO=[".mp3",".wav",".ogg",".m4a"],n.SIYUAN_ASSETS_VIDEO=[".mov",".weba",".mkv",".mp4",".webm"],n.SIYUAN_ASSETS_EXTS=[".pdf"].concat(n.SIYUAN_ASSETS_IMAGE).concat(n.SIYUAN_ASSETS_AUDIO).concat(n.SIYUAN_ASSETS_VIDEO),n.SIYUAN_CONFIG_APPEARANCE_DARK_CODE=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256"],n.SIYUAN_CONFIG_APPEARANCE_LIGHT_CODE=["ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],n.ZWSP="‚Äã",n.INLINE_TYPE=["block-ref","kbd","text","file-annotation-ref","a","strong","em","u","s","mark","sup","sub","tag","code","inline-math","inline-memo"],n.BLOCK_HINT_KEYS=["((","[[","ÔºàÔºà","„Äê„Äê"],n.BLOCK_HINT_CLOSE_KEYS={"((":"))","[[":"]]","ÔºàÔºà":"ÔºâÔºâ","„Äê„Äê":"„Äë„Äë"},n.CODE_LANGUAGES=["js","ts","html","toml","c#","bat","bash","c","csharp","cpp","css","diff","go","xml","json","java","javascript","kotlin","less","lua","makefile","markdown","objectivec","php","php-template","perl","plaintext","python","python-repl","r","ruby","rust","scss","sql","shell","swift","ini","typescript","vbnet","yaml","properties","1c","armasm","avrasm","actionscript","ada","angelscript","accesslog","apache","applescript","arcade","arduino","asciidoc","aspectj","abnf","autohotkey","autoit","awk","basic","bnf","dos","brainfuck","cal","cmake","csp","cos","capnproto","ceylon","clean","clojure","clojure-repl","coffeescript","coq","crystal","d","dns","dart","delphi","dts","django","dockerfile","dust","erb","elixir","elm","erlang","erlang-repl","excel","ebnf","fsharp","fix","flix","fortran","gcode","gams","gauss","glsl","gml","gherkin","golo","gradle","groovy","haml","hsp","http","handlebars","haskell","haxe","hy","irpf90","isbl","inform7","x86asm","jboss-cli","julia","julia-repl","ldif","llvm","lsl","latex","lasso","leaf","lisp","livecodeserver","livescript","mel","mipsasm","matlab","maxima","mercury","axapta","routeros","mizar","mojolicious","monkey","moonscript","n1ql","nsis","nestedtext","nginx","nim","nix","node-repl","ocaml","openscad","ruleslanguage","oxygene","pf","parser3","pony","pgsql","powershell","processing","prolog","protobuf","puppet","purebasic","profile","q","qml","reasonml","rib","rsl","roboconf","sas","sml","sqf","step21","scala","scheme","scilab","smali","smalltalk","stan","stata","stylus","subunit","tp","taggerscript","tcl","tap","thrift","twig","vbscript","vbscript-html","vhdl","vala","verilog","vim","wasm","mathematica","wren","xl","xquery","zephir","crmsh","dsconfig","graphql","yul","solidity","abap"],n.ANALYTICS_EVT_ON_GET_CONFIG="siyuan.onGetConfig"},640:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.confirmDialog=void 0;const i=n(955),a=n(217);t.confirmDialog=(e,t,n,s)=>{const o=new a.Dialog({title:e,content:`<div class="b3-dialog__content">${t}</div>\n<div class="b3-dialog__action">\n    <button class="b3-button b3-button--cancel">${window.siyuan.languages.cancel}</button><div class="fn__space"></div>\n    <button class="b3-button b3-button--text" id="confirmDialogConfirmBtn">${window.siyuan.languages.confirm}</button>\n</div>`,width:(0,i.isMobile)()?"80vw":"520px"}),r=o.element.querySelectorAll(".b3-button");r[0].addEventListener("click",(()=>{s&&s(),o.destroy()})),r[1].addEventListener("click",(()=>{n&&n(),o.destroy()}))}},217:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Dialog=void 0;const i=n(120),a=n(628);t.Dialog=class{constructor(e){this.disableClose=e.disableClose,this.id=(0,a.genUUID)(),window.siyuan.dialogs.push(this),this.destroyCallback=e.destroyCallback,this.element=document.createElement("div"),this.element.innerHTML=`<div class="b3-dialog">\n<div class="b3-dialog__scrim"${e.transparent?'style="background-color:transparent"':""}></div>\n<div class="b3-dialog__container" style="width:${e.width||"auto"}">\n  <svg class="b3-dialog__close fn__a${this.disableClose?" fn__none":""}"><use xlink:href="#iconClose"></use></svg>\n  <div class="b3-dialog__header${e.title?"":" fn__none"}" onselectstart="return false;">${e.title||""}</div>\n  <div style="height:${e.height||"auto"}">${e.content}</div>\n</div></div>`,this.element.querySelector(".b3-dialog__scrim").addEventListener((0,i.getEventName)(),(e=>{this.disableClose||this.destroy(),e.stopPropagation(),window.siyuan.menus.menu.remove()})),this.disableClose||this.element.querySelector(".b3-dialog__close").addEventListener((0,i.getEventName)(),(e=>{this.destroy(),e.stopPropagation()})),document.body.append(this.element),e.disableAnimation?this.element.classList.add("b3-dialog--open"):setTimeout((()=>{this.element.classList.add("b3-dialog--open")}))}destroy(){this.element.remove(),this.destroyCallback&&this.destroyCallback(),window.siyuan.dialogs.find(((e,t)=>{if(e.id===this.id)return window.siyuan.dialogs.splice(t,1),!0}))}bindInput(e,t){e.focus(),e.addEventListener("keydown",(e=>{if(!e.isComposing)return"Escape"===e.key?(this.destroy(),e.preventDefault(),void e.stopPropagation()):void("Enter"===e.key&&t&&(t(),e.preventDefault()));e.preventDefault()}))}}},751:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hideMessage=t.showMessage=t.initMessage=void 0;const i=n(628),a=n(450);t.initMessage=()=>{const e=document.getElementById("message");e.innerHTML=`<div class="fn__flex-1"></div>\n<button class="b3-button--cancel b3-button b3-tooltips b3-tooltips__w" aria-label="${window.siyuan.languages.clearMessage}"><svg style="margin-right: 0"><use xlink:href="#iconSelect"></use></svg></button>`,e.addEventListener("click",(n=>{let i=n.target;for(;i&&!i.isEqualNode(e);){if(i.classList.contains("b3-snackbar__close")){(0,t.hideMessage)(i.parentElement.getAttribute("data-id")),n.preventDefault();break}if(i.isSameNode(e.lastElementChild)){i.parentElement.classList.remove("b3-snackbars--show"),setTimeout((()=>{i.parentElement.firstElementChild.innerHTML=""}),a.Constants.TIMEOUT_INPUT),n.preventDefault();break}i=i.parentElement}}))};t.showMessage=(e,n=6e3,a="info",s)=>{const o=s||(0,i.genUUID)(),r=document.getElementById("message").firstElementChild,l=r.querySelector(`.b3-snackbar[data-id="${o}"]`);if(l){if(window.clearTimeout(parseInt(l.getAttribute("data-timeoutid"))),l.innerHTML=`<div class="b3-snackbar__content">${e}</div>${0===n?'<svg class="b3-snackbar__close"><use xlink:href="#iconClose"></use></svg>':""}`,"error"===a?l.classList.add("b3-snackbar--error"):l.classList.remove("b3-snackbar--error"),n>0){const e=window.setTimeout((()=>{(0,t.hideMessage)(o)}),n);l.setAttribute("data-timeoutid",e.toString())}return}let d=`<div data-id="${o}" class="b3-snackbar--hide b3-snackbar${"error"===a?" b3-snackbar--error":""}"><div class="b3-snackbar__content">${e}</div>`;if(0===n)d+='<svg class="b3-snackbar__close"><use xlink:href="#iconClose"></use></svg>';else if(-1!==n){const e=window.setTimeout((()=>{(0,t.hideMessage)(o)}),n);d=d.replace("<div data-id",`<div data-timeoutid="${e}" data-id`)}return r.parentElement.classList.add("b3-snackbars--show"),r.insertAdjacentHTML("afterbegin",d+"</div>"),setTimeout((()=>{r.querySelectorAll(".b3-snackbar--hide").forEach((e=>{e.classList.remove("b3-snackbar--hide")}))})),r.firstElementChild.nextElementSibling&&r.firstElementChild.nextElementSibling.innerHTML===r.firstElementChild.innerHTML&&r.firstElementChild.nextElementSibling.remove(),r.scrollTo({top:0,behavior:"smooth"}),o};t.hideMessage=e=>{const n=document.getElementById("message").firstElementChild;if(e){const i=n.querySelector(`[data-id="${e}"]`);i&&(i.classList.add("b3-snackbar--hide"),setTimeout((()=>{i.remove(),0===n.childElementCount&&(0,t.hideMessage)()}),a.Constants.TIMEOUT_INPUT));let s=!1;Array.from(n.children).find((e=>{if(!e.classList.contains("b3-snackbar--hide"))return s=!0,!0})),s?n.parentElement.classList.add("b3-snackbars--show"):n.parentElement.classList.remove("b3-snackbars--show")}else n.parentElement.classList.remove("b3-snackbars--show"),setTimeout((()=>{n.innerHTML=""}),a.Constants.TIMEOUT_INPUT)}},393:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.downloadProgress=t.setTitle=t.bootSync=t.progressLoading=t.progressStatus=t.transactionError=t.exitSiYuan=t.kernelError=t.lockFile=void 0;const i=n(450),a=n(257),s=n(751),o=n(217),r=n(955),l=n(640);t.lockFile=e=>{const t=`<div class="b3-dialog__scrim"></div>\n<div class="b3-dialog__container">\n    <div class="b3-dialog__header" onselectstart="return false;">üîí ${window.siyuan.languages.lockFile0} <small>v${i.Constants.SIYUAN_VERSION}</small></div>\n    <div class="b3-dialog__content">\n        <p>${window.siyuan.languages.lockFile1}</p>\n        <p>${window.siyuan.languages.lockFile2}</p>\n    </div>\n    <div class="b3-dialog__action">\n        <button class="b3-button b3-button--cancel">${window.siyuan.languages.closeTab}</button>\n        <div class="fn__space"></div>\n        <button class="b3-button b3-button--text">${window.siyuan.languages.retry}</button>\n    </div>\n</div>`;let n=document.getElementById("errorLog");n?n.innerHTML=t:(document.body.insertAdjacentHTML("beforeend",`<div id="errorLog" class="b3-dialog b3-dialog--open">${t}</div>`),n=document.getElementById("errorLog")),n.querySelector(".b3-button--cancel").addEventListener("click",(()=>{})),n.querySelector(".b3-button--text").addEventListener("click",(()=>{(0,a.fetchPost)("/api/filetree/lockFile",{id:e},(e=>{0===e.code&&window.location.reload()}))}))};t.kernelError=()=>{var e,t;let n="";"ios"===window.siyuan.config.system.container&&(null===(e=window.webkit)||void 0===e?void 0:e.messageHandlers)&&(n=`<div class="fn__hr"></div><div class="fn__flex"><div class="fn__flex-1"></div><button class="b3-button">${window.siyuan.languages.retry}</button></div>`);const a=`<div class="b3-dialog__scrim"></div>\n<div class="b3-dialog__container" style="width: ${(0,r.isMobile)()?"80vw":"520px"}">\n    <div class="b3-dialog__header" onselectstart="return false;">üíî ${window.siyuan.languages.kernelFault0} <small>v${i.Constants.SIYUAN_VERSION}</small></div>\n    <div class="b3-dialog__content">\n        <p>${window.siyuan.languages.kernelFault1}</p>\n        <div class="fn__hr"></div>\n        <p>${window.siyuan.languages.kernelFault2}</p>\n        ${n}\n    </div>\n</div>`;let s=document.getElementById("errorLog");s?s.innerHTML=a:(document.body.insertAdjacentHTML("beforeend",`<div id="errorLog" class="b3-dialog b3-dialog--open">${a}</div>`),s=document.getElementById("errorLog"));const o=s.querySelector(".b3-button");o&&(null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers)&&o.addEventListener("click",(()=>{s.remove(),window.webkit.messageHandlers.startKernelFast.postMessage("startKernelFast")}))};t.exitSiYuan=()=>{(0,a.fetchPost)("/api/system/exit",{force:!1},(e=>{var t;if(1===e.code){const t=(0,s.showMessage)(e.msg,e.data.closeTimeout,"error"),n=document.querySelector(`#message [data-id="${t}"] button`);n&&n.addEventListener("click",(()=>{(0,a.fetchPost)("/api/system/exit",{force:!0},(()=>{var e;["ios","android"].includes(window.siyuan.config.system.container)&&((null===(e=window.webkit)||void 0===e?void 0:e.messageHandlers)||window.JSAndroid)&&(window.location.href="siyuan://api/system/exit")}))}))}else 2===e.code?((0,s.hideMessage)(),(0,l.confirmDialog)(window.siyuan.languages.tip,e.msg,(()=>{(0,a.fetchPost)("/api/system/exit",{force:!0,execInstallPkg:2},(()=>{}))}),(()=>{(0,a.fetchPost)("/api/system/exit",{force:!0,execInstallPkg:1},(()=>{}))}))):["ios","android"].includes(window.siyuan.config.system.container)&&((null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers)||window.JSAndroid)&&(window.location.href="siyuan://api/system/exit")}))};let d;t.transactionError=e=>{if(1===e.code)return void(0,t.lockFile)(e.data);if(document.getElementById("transactionError"))return;const n=new o.Dialog({disableClose:!0,title:`${window.siyuan.languages.stateExcepted} v${i.Constants.SIYUAN_VERSION}`,content:`<div class="b3-dialog__content" id="transactionError">${window.siyuan.languages.rebuildIndexTip}</div>\n<div class="b3-dialog__action">\n    <button class="b3-button b3-button--text">${window.siyuan.languages._kernel[97]}</button>\n    <div class="fn__space"></div>\n    <button class="b3-button">${window.siyuan.languages.rebuildIndex}</button>\n</div>`,width:(0,r.isMobile)()?"80vw":"520px"}).element.querySelectorAll(".b3-button");n[0].addEventListener("click",(()=>{(0,t.exitSiYuan)()})),n[1].addEventListener("click",(()=>{(0,a.fetchPost)("/api/filetree/refreshFiletree",{})}))};t.progressStatus=e=>{if((0,r.isMobile)()){clearTimeout(d);const t=document.querySelector("#status");return t.innerHTML=e.msg,t.classList.remove("status--hide"),document.querySelector("#keyboardToolbar").classList.contains("fn__none")?t.style.bottom="0":t.style.bottom="30px",void(d=window.setTimeout((()=>{t.style.bottom=""}),6e3))}document.querySelector("#status .status__msg").innerHTML=e.msg};t.progressLoading=e=>{let t=document.getElementById("progress");t||(document.body.insertAdjacentHTML("beforeend",'<div id="progress"></div>'),t=document.getElementById("progress")),2!==e.code?0===e.code?t.innerHTML=`<div class="b3-dialog__scrim" style="z-index:400;opacity: 1"></div>\n<div style="position: fixed;top: 45vh;width: 70vw;left: 15vw;color:#fff;z-index:400;">\n    <div style="text-align: right">${e.data.current}/${e.data.total}</div>\n    <div style="margin: 8px 0;height: 8px;border-radius: 4px;overflow: hidden;background-color:#fff;"><div style="width: ${e.data.current/e.data.total*100}%;transition: var(--b3-transition);background-color: var(--b3-theme-primary);height: 8px;"></div></div>\n    <div>${e.msg}</div>\n</div>`:1===e.code&&(t.lastElementChild?t.lastElementChild.lastElementChild.innerHTML=e.msg:t.innerHTML=`<div class="b3-dialog__scrim" style="z-index:400;opacity: 1"></div>\n<div style="position: fixed;top: 45vh;width: 70vw;left: 15vw;color:#fff;z-index:400;">\n    <div style="margin: 8px 0;height: 8px;border-radius: 4px;overflow: hidden;background-color:#fff;"><div style="background-color: var(--b3-theme-primary);height: 8px;background-image: linear-gradient(-45deg, rgba(255, 255, 255, 0.2) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0.2) 75%, transparent 75%, transparent);animation: stripMove 450ms linear infinite;background-size: 50px 50px;"></div></div>\n    <div>${e.msg}</div>\n</div>`):t.remove()};t.bootSync=()=>{(0,a.fetchPost)("/api/sync/getBootSync",{},(e=>{if(1===e.code){const t=new o.Dialog({width:(0,r.isMobile)()?"80vw":"50vw",title:"üå©Ô∏è "+window.siyuan.languages.bootSyncFailed,content:`<div class="b3-dialog__content">${e.msg}</div>\n<div class="b3-dialog__action">\n    <button class="b3-button b3-button--cancel">${window.siyuan.languages.cancel}</button><div class="fn__space"></div>\n    <button class="b3-button b3-button--text">${window.siyuan.languages.syncNow}</button>\n</div>`}),n=t.element.querySelectorAll(".b3-button");n[0].addEventListener("click",(()=>{t.destroy()})),n[1].addEventListener("click",(()=>{n[1].getAttribute("disabled")||(n[1].setAttribute("disabled","disabled"),(0,a.fetchPost)("/api/sync/performBootSync",{},(e=>{0===e.code&&t.destroy(),n[1].removeAttribute("disabled")})))}))}}))};t.setTitle=e=>{const t=document.getElementById("drag");if(e===window.siyuan.languages.siyuanNote){const n=e+" v"+i.Constants.SIYUAN_VERSION;document.title=n,t.textContent=n,t.setAttribute("title",n)}else e=e||"Untitled",document.title=e+" - "+window.siyuan.languages.siyuanNote+" v"+i.Constants.SIYUAN_VERSION,t.textContent=e,t.setAttribute("title",e)};t.downloadProgress=e=>{const t=document.getElementById("configBazaarReadme");if(!t)return;const n=t.querySelector(`[data-url="${e.id}"]`);n&&(e.percent>=1?n.parentElement.classList.add("fn__none"):(n.classList.add("b3-button--progress"),n.innerHTML=`<span style="width: ${100*e.percent}%"></span>`))}},937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renderStatusbarCounter=t.clearCounter=t.countBlockWord=t.countSelectWord=t.initStatus=void 0;let n;t.initStatus=()=>{};t.countSelectWord=(e,t)=>{};t.countBlockWord=(e,t,n=!1)=>{};t.clearCounter=()=>{n="",document.querySelector("#status .status__counter").innerHTML=""};t.renderStatusbarCounter=e=>{let t=`<span class="ft__on-surface">${window.siyuan.languages.runeCount}</span>&nbsp;${e.runeCount}<span class="fn__space"></span>\n<span class="ft__on-surface">${window.siyuan.languages.wordCount}</span>&nbsp;${e.wordCount}<span class="fn__space"></span>`;0<e.linkCount&&(t+=`<span class="ft__on-surface">${window.siyuan.languages.link}</span>&nbsp;${e.linkCount}<span class="fn__space"></span>`),0<e.imageCount&&(t+=`<span class="ft__on-surface">${window.siyuan.languages.image}</span>&nbsp;${e.imageCount}<span class="fn__space"></span>`),0<e.refCount&&(t+=`<span class="ft__on-surface">${window.siyuan.languages.ref}</span>&nbsp;${e.refCount}<span class="fn__space"></span>`),document.querySelector("#status .status__counter").innerHTML=t}},163:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.abcRender=void 0;const i=n(81),a=n(450);t.abcRender=(e,t=a.Constants.PROTYLE_CDN)=>{let n=[];n="abc"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="abc"]')),0!==n.length&&n.length>0&&(0,i.addScript)(`${t}/js/abcjs/abcjs-basic-min.js?v=6.1.7`,"protyleAbcjsScript").then((()=>{n.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>'),e.childElementCount<4&&e.lastElementChild.insertAdjacentHTML("beforebegin",`<span style="position: absolute">${a.Constants.ZWSP}</span>`);const t=e.firstElementChild.nextElementSibling;ABCJS.renderAbc(t,Lute.UnEscapeHTMLStr(e.getAttribute("data-content")),{responsive:"resize"}),t.setAttribute("contenteditable","false"),e.setAttribute("data-render","true")}))}))}},475:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.chartRender=void 0;const i=n(81),a=n(450),s=n(503);t.chartRender=(e,t=a.Constants.PROTYLE_CDN)=>{let n=[];n="echarts"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="echarts"]')),0!==n.length&&n.length>0&&(0,i.addScript)(`${t}/js/echarts/echarts.min.js?v=5.3.2`,"protyleEchartsScript").then((()=>{(0,i.addScript)(`${t}/js/echarts/echarts-gl.min.js?v=2.0.9`,"protyleEchartsGLScript").then((()=>{let e;if(0===n[0].firstElementChild.clientWidth){const t=(0,s.hasClosestByClassName)(n[0],"layout-tab-container",!0);t&&Array.from(t.children).find((t=>{if(t.classList.contains("protyle")&&!t.classList.contains("fn__none"))return e=t.querySelector(".protyle-wysiwyg").firstElementChild.clientWidth,!0}))}n.forEach((t=>{if("true"===t.getAttribute("data-render"))return;t.firstElementChild.classList.contains("protyle-icons")||t.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const n=t.firstElementChild.nextElementSibling;try{n.style.height=t.style.height;const i=JSON.parse(Lute.UnEscapeHTMLStr(t.getAttribute("data-content")));echarts.init(n,1===window.siyuan.config.appearance.mode?"dark":void 0,{width:e}).setOption(i),t.setAttribute("data-render","true"),n.classList.remove("ft__error"),n.textContent.endsWith(a.Constants.ZWSP)||n.firstElementChild.insertAdjacentText("beforeend",a.Constants.ZWSP)}catch(e){echarts.dispose(n),n.classList.add("ft__error"),n.innerHTML=`echarts render error: <br>${e}`}}))}))}))}},509:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.flowchartRender=void 0;const i=n(81),a=n(450),s=n(503);t.flowchartRender=(e,t=a.Constants.PROTYLE_CDN)=>{let n=[];n="flowchart"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="flowchart"]')),0!==n.length&&(0,i.addScript)(`${t}/js/flowchart.js/flowchart.min.js?v=0.0.0`,"protyleFlowchartScript").then((()=>{if(0===n[0].firstElementChild.clientWidth){const e=(0,s.hasClosestByClassName)(n[0],"protyle",!0);if(!e)return;const t=new MutationObserver((()=>{o(n),t.disconnect()}));t.observe(e,{attributeFilter:["class"]})}else o(n)}))};const o=e=>{e.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>'),e.childElementCount<4&&e.lastElementChild.insertAdjacentHTML("beforebegin",`<span style="position: absolute">${a.Constants.ZWSP}</span>`);const t=e.firstElementChild.nextElementSibling,n=flowchart.parse(Lute.UnEscapeHTMLStr(e.getAttribute("data-content")));t.innerHTML="";try{n.drawSVG(t)}catch(e){t.classList.add("ft__error"),t.innerHTML=`Flow Chart render error: <br>${e}`}t.setAttribute("contenteditable","false"),e.setAttribute("data-render","true")}))}},364:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.graphvizRender=void 0;const i=n(81),a=n(450);t.graphvizRender=(e,t=a.Constants.PROTYLE_CDN)=>{let n=[];n="graphviz"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="graphviz"]')),0!==n.length&&(0,i.addScript)(`${t}/js/graphviz/viz.js?v=0.0.0`,"protyleGraphVizScript").then((()=>{n.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const t=e.firstElementChild.nextElementSibling;try{const n=new Blob([`importScripts('${document.getElementById("protyleGraphVizScript").src.replace("viz.js","full.render.js")}');`],{type:"application/javascript"}),i=(window.URL||window.webkitURL).createObjectURL(n),s=new Worker(i);new Viz({worker:s}).renderSVGElement(Lute.UnEscapeHTMLStr(e.getAttribute("data-content"))).then((n=>{t.innerHTML=n.outerHTML,t.classList.remove("ft__error"),t.setAttribute("contenteditable","false"),e.textContent.endsWith(a.Constants.ZWSP)||e.insertAdjacentHTML("beforeend",`<span style="position: absolute">${a.Constants.ZWSP}</span>`)})).catch((e=>{t.innerHTML=`graphviz render error: <br>${e}`,t.classList.add("ft__error")}))}catch(e){console.error("Graphviz error",e)}e.setAttribute("data-render","true")}))}))}},631:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lineNumberRender=t.highlightRender=void 0;const i=n(81),a=n(450),s=n(246),o=n(61);t.highlightRender=(e,n=a.Constants.PROTYLE_CDN)=>{let r,l=!1;e.classList.contains("code-block")?r=e.querySelectorAll('[spellcheck="false"]'):e.classList.contains("item__readme")?(r=e.querySelectorAll("pre code"),r.forEach((e=>{e.parentElement.setAttribute("lineNumber","false")}))):e.classList.contains("b3-typography")?(r=e.querySelectorAll(".code-block code"),l=!0):r=e.querySelectorAll('.code-block [spellcheck="false"]'),0!==r.length&&((0,o.setCodeTheme)(n),(0,i.addScript)(`${n}/js/highlight.js/highlight.min.js?v=11.7.0`,"protyleHljsScript").then((()=>{(0,i.addScript)(`${n}/js/highlight.js/third-languages.js?v=1.0.1`,"protyleHljsThirdScript").then((()=>{r.forEach((e=>{var n;if("true"===e.getAttribute("data-render"))return;const i=e.querySelector("wbr");let a,o=0;if(i){let e=i.previousSibling;for(;e;){for(o+=e.textContent.length;!e.previousSibling&&"DIV"!==e.parentElement.tagName;)e=e.parentElement;e=e.previousSibling}i.remove()}a=l?e.parentElement.getAttribute("data-language"):e.previousElementSibling?e.previousElementSibling.firstElementChild.textContent:e.className.replace("language-",""),hljs.getLanguage(a)||(a="plaintext"),e.classList.add("hljs"),e.setAttribute("data-render","true");const r=e.parentElement.getAttribute("linewrap"),d=e.parentElement.getAttribute("ligatures"),c=e.parentElement.getAttribute("linenumber");"true"===r||"false"!==r&&window.siyuan.config.editor.codeLineWrap?(e.style.setProperty("white-space","pre-wrap"),e.style.setProperty("word-break","break-all")):(e.style.setProperty("white-space","pre"),e.style.setProperty("word-break","initial")),"true"===d||"false"!==d&&window.siyuan.config.editor.codeLigatures?e.style.fontVariantLigatures="normal":e.style.fontVariantLigatures="none";const u=e.parentElement.querySelector(".protyle-action__language");!l&&("true"===c||"false"!==c&&window.siyuan.config.editor.codeSyntaxHighlightLineNum)?(e.classList.add("protyle-linenumber"),setTimeout((()=>{(0,t.lineNumberRender)(e)}),20),u&&(u.style.marginLeft="3.6em")):(null===(n=e.nextElementSibling)||void 0===n?void 0:n.classList.contains("protyle-linenumber__rows"))&&(e.classList.remove("protyle-linenumber"),e.nextElementSibling.remove(),u&&(u.style.marginLeft=""));const g=e.querySelector('span[data-type="search-mark"]');g&&g.scrollIntoView(),e.innerHTML=hljs.highlight(e.textContent+(e.textContent.endsWith("\n")?"":"\n"),{language:a,ignoreIllegals:!0}).value,i&&getSelection().rangeCount>0&&(0,s.focusByOffset)(e,o,o)}))}))})))};t.lineNumberRender=e=>{var t;if("false"===e.parentElement.getAttribute("lineNumber"))return;if(e.nextElementSibling&&e.nextElementSibling.clientHeight===e.clientHeight)return;e.classList.add("protyle-linenumber");const n=document.createElement("div");n.className="hljs protyle-linenumber",n.setAttribute("style",`padding-top:0 !important;padding-bottom:0 !important;min-height:auto !important;white-space:${e.style.whiteSpace};word-break:${e.style.wordBreak};font-variant-ligatures:${e.style.fontVariantLigatures};`),n.setAttribute("contenteditable","true"),e.insertAdjacentElement("afterend",n);let i="";const a=e.textContent.split(/\r\n|\r|\n|\u2028|\u2029/g);""===a[a.length-1]&&a.length>1&&a.pop();const s="break-all"===e.style.wordBreak;a.map((e=>{let t="";if(s){n.textContent=e||"\n";t=` style="height:${n.getBoundingClientRect().height}px;"`}i+=`<span${t}></span>`})),n.remove(),(null===(t=e.nextElementSibling)||void 0===t?void 0:t.classList.contains("protyle-linenumber__rows"))?e.nextElementSibling.innerHTML=i:e.insertAdjacentHTML("afterend",`<span contenteditable="false" class="protyle-linenumber__rows">${i}</span>`)}},430:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mathRender=void 0;const i=n(81),a=n(783),s=n(450),o=n(688),r=n(503);t.mathRender=(e,t=s.Constants.PROTYLE_CDN,n=!1)=>{let l=[];l="math"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="math"]')),0!==l.length&&((0,a.addStyle)(`${t}/js/katex/katex.min.css?v=0.16.0`,"protyleKatexStyle"),(0,i.addScript)(`${t}/js/katex/katex.min.js?v=0.16.0`,"protyleKatexScript").then((()=>{(0,i.addScript)(`${t}/js/katex/mhchem.min.js?v=0.16.0`,"protyleKatexMhchemScript").then((()=>{l.forEach((e=>{var t,i;if("true"===e.getAttribute("data-render"))return;e.setAttribute("data-render","true");let a=e;"DIV"===e.tagName&&(a=e.firstElementChild);let l={};try{l=JSON.parse(window.siyuan.config.editor.katexMacros||"{}")}catch(e){console.warn("KaTex macros is not JSON",e)}try{a.innerHTML=katex.renderToString(Lute.UnEscapeHTMLStr(e.getAttribute("data-content")),{displayMode:"DIV"===e.tagName,output:"html",macros:l}),a.classList.remove("ft__error");const d=(0,r.hasClosestBlock)(e);if("DIV"===e.tagName){a.firstElementChild.setAttribute("contenteditable","false"),a.childElementCount<2&&a.insertAdjacentHTML("beforeend",`<span style="position: absolute">${s.Constants.ZWSP}</span>`);const e=a.querySelectorAll(".base");e.length>0&&e[e.length-1].insertAdjacentHTML("afterend","<span class='fn__flex-1'></span>");const t=a.querySelector(".katex-html > .newline");t&&(t.parentElement.style.display="block")}else{d&&e.getBoundingClientRect().width>d.clientWidth?(e.style.maxWidth="100%",e.style.overflowX="auto",e.style.overflowY="hidden",e.style.display="inline-block"):(e.style.maxWidth="",e.style.overflowX="",e.style.overflowY="",e.style.display="");const n=(0,o.hasNextSibling)(e);n?n&&3!==n.nodeType&&(null===(t=n.getAttribute("data-type"))||void 0===t?void 0:t.indexOf("inline-math"))>-1?e.after(document.createTextNode(s.Constants.ZWSP)):n&&!n.textContent.startsWith("\n")&&n.textContent!==s.Constants.ZWSP&&e.insertAdjacentHTML("beforeend","&#xFEFF;"):"TH"!==e.parentElement.tagName&&"TD"!==e.parentElement.tagName?e.insertAdjacentText("afterend","\n"):e.insertAdjacentText("afterend",s.Constants.ZWSP),(null===(i=e.previousSibling)||void 0===i?void 0:i.textContent.endsWith("\n"))?e.insertAdjacentText("beforebegin",s.Constants.ZWSP):!(0,o.hasPreviousSibling)(e)&&["TH","TD"].includes(e.parentElement.tagName)&&e.insertAdjacentText("afterbegin",s.Constants.ZWSP)}n&&setTimeout((()=>{if("DIV"===e.tagName){const t=e.querySelector(".katex-display");t.clientWidth<t.scrollWidth&&t.firstElementChild.setAttribute("style",`font-size:${100*t.clientWidth/t.scrollWidth}%`)}else d&&e.offsetWidth>d.clientWidth&&e.firstElementChild.setAttribute("style",`font-size:${100*d.clientWidth/e.offsetWidth}%`)}))}catch(e){a.innerHTML=e.message,a.classList.add("ft__error")}}))}))})))}},608:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mermaidRender=void 0;const i=n(81),a=n(450),s=n(503);t.mermaidRender=(e,t=a.Constants.PROTYLE_CDN)=>{let n=[];n="mermaid"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="mermaid"]')),0!==n.length&&(0,i.addScript)(`${t}/js/mermaid/mermaid.min.js?v=9.1.7`,"protyleMermaidScript").then((()=>{const e={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8},gantt:{leftPadding:75,rightPadding:20}};if(1===window.siyuan.config.appearance.mode&&(e.theme="dark"),mermaid.initialize(e),0===n[0].firstElementChild.clientWidth){const e=(0,s.hasClosestByClassName)(n[0],"protyle",!0);if(!e)return;const t=new MutationObserver((()=>{o(n),t.disconnect()}));t.observe(e,{attributeFilter:["class"]})}else o(n)}))};const o=e=>{e.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const t=e.firstElementChild.nextElementSibling;t.removeAttribute("data-processed"),t.textContent=Lute.UnEscapeHTMLStr(e.getAttribute("data-content")),mermaid.init(void 0,t),e.setAttribute("data-render","true"),t.setAttribute("contenteditable","false"),e.textContent.endsWith(a.Constants.ZWSP)||e.insertAdjacentHTML("beforeend",`<span style="position: absolute">${a.Constants.ZWSP}</span>`)}))}},938:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mindmapRender=void 0;const i=n(81),a=n(450),s=n(503);t.mindmapRender=(e,t=a.Constants.PROTYLE_CDN)=>{let n=[];n="mindmap"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="mindmap"]')),0!==n.length&&(0,i.addScript)(`${t}/js/echarts/echarts.min.js?v=0.0.0`,"protyleEchartsScript").then((()=>{let e;if(0===n[0].firstElementChild.clientWidth){const t=(0,s.hasClosestByClassName)(n[0],"layout-tab-container",!0);t&&Array.from(t.children).find((t=>{if(t.classList.contains("protyle")&&!t.classList.contains("fn__none")&&t.querySelector(".protyle-wysiwyg").firstElementChild)return e=t.querySelector(".protyle-wysiwyg").firstElementChild.clientWidth,!0}))}n.forEach((t=>{if("true"===t.getAttribute("data-render"))return;t.firstElementChild.classList.contains("protyle-icons")||t.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const n=t.firstElementChild.nextElementSibling;try{n.style.height=t.style.height,echarts.init(n,1===window.siyuan.config.appearance.mode?"dark":void 0,{width:e}).setOption({series:[{data:[JSON.parse(Lute.EChartsMindmapStr(Lute.UnEscapeHTMLStr(t.getAttribute("data-content"))))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:(e,t)=>{var n;return(null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.children)?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"},backgroundColor:"transparent"}),t.setAttribute("data-render","true"),n.textContent.endsWith(a.Constants.ZWSP)||n.firstElementChild.insertAdjacentText("beforeend",a.Constants.ZWSP),n.classList.remove("ft__error")}catch(e){n.classList.add("ft__error"),n.innerHTML=`Mindmap render error: <br>${e}`}}))}))}},696:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.plantumlRender=void 0;const i=n(81),a=n(450);t.plantumlRender=(e,t=a.Constants.PROTYLE_CDN)=>{let n=[];n="plantuml"===e.getAttribute("data-subtype")?[e]:Array.from(e.querySelectorAll('[data-subtype="plantuml"]')),0!==n.length&&(0,i.addScript)(`${t}/js/plantuml/plantuml-encoder.min.js?v=0.0.0`,"protylePlantumlScript").then((()=>{n.forEach((e=>{if("true"===e.getAttribute("data-render"))return;e.firstElementChild.classList.contains("protyle-icons")||e.insertAdjacentHTML("afterbegin",'<div class="protyle-icons"><span class="protyle-icon protyle-icon--first protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span><span class="protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span></div>');const t=e.firstElementChild.nextElementSibling;try{t.innerHTML=`<img src=${window.siyuan.config.editor.plantUMLServePath}${plantumlEncoder.encode(Lute.UnEscapeHTMLStr(e.getAttribute("data-content")))}">`,t.classList.remove("ft__error"),e.setAttribute("data-render","true")}catch(e){t.classList.add("ft__error"),t.innerHTML=`plantuml render error: <br>${e}`}}))}))}},889:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hideElements=void 0;t.hideElements=(e,t,n=!1)=>{if(t){if(e.includes("hint")&&(clearTimeout(t.hint.timeId),t.hint.element.classList.add("fn__none")),t.gutter&&e.includes("gutter")&&(t.gutter.element.classList.add("fn__none"),t.gutter.element.innerHTML="",t.wysiwyg.element.querySelectorAll(".protyle-wysiwyg--hl").forEach((e=>{e.classList.remove("protyle-wysiwyg--hl")}))),t.toolbar&&e.includes("toolbar")&&(t.toolbar.element.classList.add("fn__none"),t.toolbar.element.style.display=""),t.toolbar&&e.includes("util")){const e=t.toolbar.subElement.querySelector('[data-type="pin"]');(n||!e||e&&!e.classList.contains("block__icon--active"))&&(t.toolbar.subElement.classList.add("fn__none"),t.toolbar.subElementCloseCB&&(t.toolbar.subElementCloseCB(),t.toolbar.subElementCloseCB=void 0))}e.includes("select")&&t.wysiwyg.element.querySelectorAll(".protyle-wysiwyg--select").forEach((e=>{e.classList.remove("protyle-wysiwyg--select"),e.removeAttribute("select-start"),e.removeAttribute("select-end")}))}else if(e.includes("dialog"))for(let e=0;e<window.siyuan.dialogs.length;e++)window.siyuan.dialogs[e].destroy(),e--}},81:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addScript=t.addScriptSync=void 0;t.addScriptSync=(e,t)=>{if(document.getElementById(t))return!1;const n=new XMLHttpRequest;n.open("GET",e,!1),n.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),n.send("");const i=document.createElement("script");i.type="text/javascript",i.text=n.responseText,i.id=t,document.head.appendChild(i)};t.addScript=(e,t)=>new Promise((n=>{if(document.getElementById(t))return n(!1),!1;const i=document.createElement("script");i.src=e,i.async=!0,document.head.appendChild(i),i.onload=()=>{if(document.getElementById(t))return i.remove(),n(!1),!1;i.id=t,n(!0)}}))},783:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addStyle=void 0;t.addStyle=(e,t)=>{if(!document.getElementById(t)){const n=document.createElement("link");n.id=t,n.rel="stylesheet",n.type="text/css",n.href=e,document.getElementsByTagName("head")[0].appendChild(n)}}},120:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function r(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.exportLocalStorage=t.setLocalStorage=t.hotKey2Electron=t.updateHotkeyTip=t.isMac=t.isCtrl=t.getEventName=t.copyPlainText=t.writeText=t.readText=t.openByMobile=void 0;const a=n(246),s=n(257),o=n(450);t.openByMobile=e=>{e&&("ios"===window.siyuan.config.system.container?window.location.href=e:"android"===window.siyuan.config.system.container&&window.JSAndroid?window.JSAndroid.openExternal(e):window.open(e))};t.readText=()=>i(void 0,void 0,void 0,(function*(){return"android"===window.siyuan.config.system.container&&window.JSAndroid?window.JSAndroid.readClipboard():navigator.clipboard.readText()}));t.writeText=e=>i(void 0,void 0,void 0,(function*(){var t,n;let i;getSelection().rangeCount>0&&(i=getSelection().getRangeAt(0).cloneRange());try{if("android"===window.siyuan.config.system.container&&window.JSAndroid)return void window.JSAndroid.writeClipboard(e);if("ios"===window.siyuan.config.system.container&&(null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers))return void window.webkit.messageHandlers.setClipboard.postMessage(e);navigator.clipboard.writeText(e)}catch(t){if("ios"===window.siyuan.config.system.container&&(null===(n=window.webkit)||void 0===n?void 0:n.messageHandlers))window.webkit.messageHandlers.setClipboard.postMessage(e);else if("android"===window.siyuan.config.system.container&&window.JSAndroid)window.JSAndroid.writeClipboard(e);else{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t),i&&(0,a.focusByRange)(i)}}}));t.copyPlainText=e=>i(void 0,void 0,void 0,(function*(){e=e.replace(new RegExp(o.Constants.ZWSP,"g"),""),yield(0,t.writeText)(e)}));t.getEventName=()=>navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click";t.isCtrl=e=>(0,t.isMac)()?!(!e.metaKey||e.ctrlKey):!(e.metaKey||!e.ctrlKey);t.isMac=()=>navigator.platform.toUpperCase().indexOf("MAC")>-1;t.updateHotkeyTip=e=>{if(/Mac/.test(navigator.platform)||"iPhone"===navigator.platform)return e;const t=new Map(Object.entries({"‚åò":"Ctrl","‚áß":"Shift","‚å•":"Alt","‚á•":"Tab","‚å´":"Backspace","‚å¶":"Delete","‚Ü©":"Enter"})),n=[];e.indexOf("‚åò")>-1&&n.push(t.get("‚åò")),e.indexOf("‚áß")>-1&&n.push(t.get("‚áß")),e.indexOf("‚å•")>-1&&n.push(t.get("‚å•"));const i=e.replace(/‚åò|‚áß|‚å•/g,"");return i&&n.push(t.get(i)||i),n.join("+")};t.hotKey2Electron=e=>{let t="";return e.indexOf("‚åò")>-1&&(t+="CommandOrControl+"),e.indexOf("‚áß")>-1&&(t+="Shift+"),e.indexOf("‚å•")>-1&&(t+="Alt+"),t+e.substr(e.length-1)};t.setLocalStorage=()=>{(0,s.fetchPost)("/api/storage/getLocalStorage",void 0,(e=>{e.data?(localStorage.clear(),Object.keys(e.data).forEach((t=>{"setItem"!==t&&"removeItem"!==t&&localStorage.setItem(t,e.data[t])}))):(0,t.exportLocalStorage)()})),window.__localStorage__setItem=localStorage.setItem,window.__localStorage__removeItem=localStorage.removeItem,localStorage.setItem=function(e,t){window.__localStorage__setItem.call(this,e,t),(0,s.fetchPost)("/api/storage/setLocalStorageVal",{key:e,val:t})},localStorage.removeItem=function(e){window.__localStorage__removeItem.call(this,e),(0,s.fetchPost)("/api/storage/removeLocalStorageVal",{key:e})}};t.exportLocalStorage=e=>{(0,s.fetchPost)("/api/storage/setLocalStorage",{val:localStorage},(()=>{e&&e()}))}},503:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasClosestByClassName=t.hasClosestByMatchTag=t.hasClosestBlock=t.hasClosestByAttribute=t.hasTopClosestByAttribute=t.hasTopClosestByTag=t.hasTopClosestByClassName=t.hasClosestByTag=void 0;t.hasClosestByTag=(e,t)=>{if(!e)return!1;3===e.nodeType&&(e=e.parentElement);let n=e,i=!1;for(;n&&!i&&!n.classList.contains("b3-typography");)0===n.nodeName.indexOf(t)?i=!0:n=n.parentElement;return i&&n};t.hasTopClosestByClassName=(e,n,i=!1)=>{let a=(0,t.hasClosestByClassName)(e,n,i),s=!1,o=!1;for(;a&&(i?"BODY"!==a.tagName:!a.classList.contains("protyle-wysiwyg"))&&!o;)s=(0,t.hasClosestByClassName)(a.parentElement,n,i),s?a=s:o=!0;return a||!1};t.hasTopClosestByTag=(e,n)=>{let i=(0,t.hasClosestByTag)(e,n),a=!1,s=!1;for(;i&&!i.classList.contains("protyle-wysiwyg")&&!s;)a=(0,t.hasClosestByTag)(i.parentElement,n),a?i=a:s=!0;return i||!1};t.hasTopClosestByAttribute=(e,n,i,a=!1)=>{let s=(0,t.hasClosestByAttribute)(e,n,i,a),o=!1,r=!1;for(;s&&!s.classList.contains("protyle-wysiwyg")&&!r;)o=(0,t.hasClosestByAttribute)(s.parentElement,n,i,a),o?s=o:r=!0;return s||!1};t.hasClosestByAttribute=(e,t,n,i=!1)=>{var a;if(!e)return!1;3===e.nodeType&&(e=e.parentElement);let s=e,o=!1;for(;s&&!o&&(i?"BODY"!==s.tagName:!s.classList.contains("protyle-wysiwyg"));)"string"==typeof n&&(null===(a=s.getAttribute(t))||void 0===a?void 0:a.split(" ").includes(n))||"string"!=typeof n&&s.hasAttribute(t)?o=!0:s=s.parentElement;return o&&s};t.hasClosestBlock=e=>{var n;const i=(0,t.hasClosestByAttribute)(e,"data-node-id",null);return!(!i||"BUTTON"===i.tagName||!(null===(n=i.getAttribute("data-type"))||void 0===n?void 0:n.startsWith("Node")))&&i};t.hasClosestByMatchTag=(e,t)=>{if(!e)return!1;3===e.nodeType&&(e=e.parentElement);let n=e,i=!1;for(;n&&!i&&!n.classList.contains("protyle-wysiwyg");)n.nodeName===t?i=!0:n=n.parentElement;return i&&n};t.hasClosestByClassName=(e,t,n=!1)=>{if(!e)return!1;3===e.nodeType&&(e=e.parentElement);let i=e,a=!1;for(;i&&!a&&(n?"BODY"!==i.tagName:!i.classList.contains("protyle-wysiwyg"));)i.classList.contains(t)?a=!0:i=i.parentElement;return a&&i}},246:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.focusSideBlock=t.focusBlock=t.focusByRange=t.focusByWbr=t.focusByOffset=t.setFirstNodeRange=t.setLastNodeRange=t.getSelectionOffset=t.getSelectionPosition=t.getEditorRange=t.selectAll=t.fixTableRange=void 0;const i=n(688),a=n(503),s=n(937),o=n(889);t.fixTableRange=e=>{const t=(0,a.hasClosestByAttribute)(e.startContainer,"data-type","NodeTable");if(""!==e.toString()&&t&&3!==e.commonAncestorContainer.nodeType){const n=e.commonAncestorContainer.tagName;if("TH"!==n&&"TD"!==n){const n=(0,a.hasClosestByMatchTag)(e.startContainer,"TD")||(0,a.hasClosestByMatchTag)(e.startContainer,"TH"),i=(0,a.hasClosestByMatchTag)(e.endContainer,"TD")||(0,a.hasClosestByMatchTag)(e.endContainer,"TH");if(n||i){if(n&&!n.contains(e.endContainer)){const t=e.cloneRange();e.setEnd(n.lastChild,n.lastChild.textContent.length),""===e.toString()&&i&&(e.setStart(i.firstChild,0),e.setEnd(t.endContainer,t.endOffset))}}else{const n=t.querySelector("th")||t.querySelector("td");e.setStart(n.firstChild,0),e.setEnd(n.lastChild,n.lastChild.textContent.length)}}}};t.selectAll=(e,n,r)=>{const l=(0,i.getContenteditableElement)(n);if(l){let i;if("TABLE"===l.tagName){const o=(0,a.hasClosestByMatchTag)(r.startContainer,"TD")||(0,a.hasClosestByMatchTag)(r.startContainer,"TH");if(o&&(i=(0,t.getSelectionOffset)(o,n,r),0!==i.start||i.end!==o.textContent.length))return r.setStart(o.firstChild,0),r.setEndAfter(o.lastChild),e.toolbar.render(e,r),(0,s.countSelectWord)(r,e.block.rootID),!0}else if(i=(0,t.getSelectionOffset)(l,n,r),0!==i.start||i.end!==l.textContent.length){let t=l.firstChild;for(;t;)if(3===t.nodeType){if(""!==t.textContent){r.setStart(t,0);break}t=t.nextSibling}else{if(t.classList.contains("render-node")||t.classList.contains("img")){r.setStartBefore(t);break}t=t.firstChild}let n=l.lastChild;for(;n;)if(3===n.nodeType){if(""!==n.textContent){r.setEnd(n,n.textContent.length);break}n=n.previousSibling}else{if(n.classList.contains("render-node")||n.classList.contains("img")||"BR"===n.tagName){r.setEndAfter(n);break}n=n.lastChild}return e.toolbar.render(e,r),(0,s.countSelectWord)(r,e.block.rootID),!0}}r.collapse(!0);const d=e.wysiwyg.element.querySelectorAll(".protyle-wysiwyg--select");if(e.wysiwyg.element.childElementCount===d.length&&d[0].parentElement.isSameNode(e.wysiwyg.element))return!0;(0,o.hideElements)(["select"],e);const c=[];Array.from(e.wysiwyg.element.children).forEach((e=>{e.classList.add("protyle-wysiwyg--select"),c.push(e.getAttribute("data-node-id"))})),(0,s.countBlockWord)(c,e.block.rootID)};t.getEditorRange=e=>{let t,n;return getSelection().rangeCount>0&&(t=getSelection().getRangeAt(0),e.isSameNode(t.startContainer)||e.contains(t.startContainer))||(e.focus({preventScroll:!0}),e.classList.contains("table")?n=e.querySelector("th")||e.querySelector("td"):(n=(0,i.getContenteditableElement)(e),n?"TABLE"===n.tagName&&(n=n.querySelector("th")||e.querySelector("td")):n=e),t=n.ownerDocument.createRange(),t.setStart(n||e,0),t.collapse(!0)),t};t.getSelectionPosition=(e,n)=>{if(n||(n=(0,t.getEditorRange)(e)),!e.contains(n.startContainer))return{left:0,top:0};let i;if(0===n.getClientRects().length)if(3===n.startContainer.nodeType){const e=n.startContainer.parentElement;if(!(e&&e.getClientRects().length>0))return{left:0,top:0};i=e.getClientRects()[0]}else{const e=n.startContainer.children;if(e[n.startOffset]&&e[n.startOffset].getClientRects().length>0)i=e[n.startOffset].getClientRects()[0];else if(n.startContainer.childNodes.length>0){const e=n.cloneRange();n.selectNode(n.startContainer.childNodes[Math.max(0,n.startOffset-1)]),i=n.getClientRects()[0],n.setEnd(e.endContainer,e.endOffset),n.setStart(e.startContainer,e.startOffset)}else i=n.startContainer.getClientRects()[0];if(!i){let e=n.startContainer.childNodes[n.startOffset];for(e||(e=n.startContainer.childNodes[n.startOffset-1]);!e.getClientRects||e.getClientRects&&0===e.getClientRects().length;)e=e.parentElement;i=e.getClientRects()[0]}}else{const e=n.getClientRects();i=e[e.length-1]}return{left:i.left,top:i.top}};function r(e,t,n,i){if(!t)return!1;if(n(t))return!0;for(let e=0,i=t.childNodes.length;e<i;e++)if(r(t,t.childNodes[e],n,!0))return!0;if(!i){let i=t;for(;i&&i!==e;){let t=i.nextSibling;for(;t;){if(r(e,t,n,!0))return!0;t=t.nextSibling}i=i.parentNode}}return!1}t.getSelectionOffset=(e,t,n)=>{const i={end:0,start:0};if(!n){if(0===getSelection().rangeCount)return i;n=window.getSelection().getRangeAt(0)}if(t&&!((e,t)=>{if(!t){if(0===getSelection().rangeCount)return!1;t=getSelection().getRangeAt(0)}const n=t.commonAncestorContainer;return e.isEqualNode(n)||e.contains(n)})(t,n))return i;const a=n.cloneRange();return e.childNodes[0]&&e.childNodes[0].childNodes[0]?a.setStart(e.childNodes[0].childNodes[0],0):a.selectNodeContents(e),a.setEnd(n.startContainer,n.startOffset),i.start=a.toString().length,i.end=i.start+n.toString().length,i};t.setLastNodeRange=(e,t,n=!0)=>{if(!e)return t;let i=e.lastChild;for(;i&&3!==i.nodeType;)i=i.lastChild;return i?(n?t.setStart(i,i.textContent.length):t.setEnd(i,i.textContent.length),t):(t.selectNodeContents(e),t)};t.setFirstNodeRange=(e,t)=>{if(!e)return t;let n=e.firstChild;for(;n&&3!==n.nodeType&&!n.classList.contains("render-node");){if(n.classList.contains("img"))return t.setStartBefore(n),t;n=n.firstChild}return n?(3!==n.nodeType&&n.classList.contains("render-node")?t.setStartBefore(n):t.setStart(n,0),t):(t.selectNodeContents(e),t)};t.focusByOffset=(e,n,a)=>{if(!e)return!1;const s=(0,i.getContenteditableElement)(e);if(s)e=s;else if((0,i.isNotEditBlock)(e))return(0,t.focusBlock)(e);let o,l;r(e,e.firstChild,(e=>{if(e.nodeType===Node.TEXT_NODE){const t=e.data.length;return n<=t?(o=e,!0):(n-=t,a-=t,!1)}})),o&&r(e,o,(e=>{if(e.nodeType===Node.TEXT_NODE){const t=e.data.length;return a<=t?(l=e,!0):(a-=t,!1)}}));const d=document.createRange();return o?n<o.data.length?d.setStart(o,n):d.setStartAfter(o):0===n?d.setStart(e,0):(0,t.setLastNodeRange)((0,i.getContenteditableElement)(e),d),l?a<l.data.length?d.setEnd(l,a):d.setEndAfter(l):0===a?d.setEnd(e,0):(0,t.setLastNodeRange)((0,i.getContenteditableElement)(e),d,!1),(0,t.focusByRange)(d),d};t.focusByWbr=(e,n)=>{var a;const s=e.querySelectorAll("wbr");if(0===s.length)return;s.forEach(((e,t)=>{0!==t&&e.remove()}));const o=s[0];if(o.previousElementSibling){const e=(0,i.hasPreviousSibling)(o);e&&o.previousElementSibling.isSameNode(e)?3===(null===(a=o.previousElementSibling.lastChild)||void 0===a?void 0:a.nodeType)?n.setStart(o.previousElementSibling.lastChild,o.previousElementSibling.lastChild.textContent.length):3!==e.nodeType&&e.classList.contains("img")?n.setStartAfter(e):n.setStartBefore(o):n.setStart(o.previousSibling,o.previousSibling.textContent.length)}else o.previousSibling?n.setStart(o.previousSibling,o.previousSibling.textContent.length):o.nextSibling?3===o.nextSibling.nodeType?n.setStart(o.nextSibling,0):n.setStartAfter(o):n.setStart(o.parentElement,0);n.collapse(!0),o.remove(),(0,t.focusByRange)(n)};t.focusByRange=e=>{if(!e)return;const t=window.getSelection();t.removeAllRanges(),t.addRange(e)};t.focusBlock=(e,n,a=!0)=>{var s,o,r;if(!e)return!1;if(e.classList.contains("render-node")||e.classList.contains("iframe")||e.classList.contains("hr")){const n=document.createRange(),i=e.getAttribute("data-type");let a=!1;return"NodeThematicBreak"===i?(n.selectNodeContents(e.firstElementChild),a=!0):"NodeBlockQueryEmbed"===i?((null===(s=e.lastElementChild.previousElementSibling)||void 0===s?void 0:s.firstChild)?(n.selectNodeContents(e.lastElementChild.previousElementSibling.firstChild),n.collapse(!0)):(n.selectNodeContents(e),n.collapse(!0)),a=!0):["NodeMathBlock","NodeHTMLBlock"].includes(i)?((null===(r=null===(o=e.lastElementChild.previousElementSibling)||void 0===o?void 0:o.lastElementChild)||void 0===r?void 0:r.firstChild)?(n.selectNodeContents(e.lastElementChild.previousElementSibling.lastElementChild.firstChild),n.collapse(!0)):e.lastElementChild.previousElementSibling&&(n.selectNodeContents(e.lastElementChild.previousElementSibling),n.collapse(!0)),a=!0):"NodeIFrame"===i||"NodeWidget"===i?(n.setStart(e,0),a=!0):"NodeVideo"===i?(n.setStart(e.firstElementChild,0),a=!0):"NodeAudio"===i?(n.setStart(e.firstElementChild.lastChild,0),a=!0):"NodeCodeBlock"===i&&(n.selectNodeContents(e),n.collapse(!0),a=!0),a?((0,t.focusByRange)(n),n):((0,t.focusSideBlock)(e),!1)}let l;if(a?l=(0,i.getContenteditableElement)(e):Array.from(e.querySelectorAll('[contenteditable="true"]')).reverse().find((e=>{if(e.getBoundingClientRect().width>0)return l=e,!0})),l){if("TABLE"===l.tagName)if(a)l=l.querySelector("th, td");else{const e=l.querySelectorAll("th, td");l=e[e.length-1]}let e;return a?(e=(0,t.setFirstNodeRange)(l,(0,t.getEditorRange)(l)),e.collapse(!0)):(e=(0,t.setLastNodeRange)(l,(0,t.getEditorRange)(l)),e.collapse(!1)),(0,t.focusByRange)(e),e}return n&&n.focus(),!1};t.focusSideBlock=e=>{if(e.getAttribute("data-node-id")){let n,a;return e.nextElementSibling&&!e.nextElementSibling.classList.contains("protyle-attr")?(a=!0,n=(0,i.getNextBlock)(e)):e.previousElementSibling&&(a=!1,n=(0,i.getPreviousBlock)(e)),n||(n=e),void(0,t.focusBlock)(n,void 0,a)}const n=(0,t.getEditorRange)(e);e.nextSibling?(n.selectNodeContents(e.nextSibling),n.collapse(!0)):e.previousSibling&&(n.selectNodeContents(e.previousSibling),n.collapse(!1)),(0,t.focusByRange)(n)}},688:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPreviousFileLi=t.getNextFileLi=t.hasPreviousSibling=t.hasNextSibling=t.getTopAloneElement=t.getTopEmptyElement=t.isNotEditBlock=t.getContenteditableElement=t.getNoContainerElement=t.getNextBlock=t.getFirstBlock=t.getLastBlock=t.getPreviousBlock=t.getPreviousHeading=void 0;const i=n(503),a=n(450);t.getPreviousHeading=e=>{let n=(0,t.getPreviousBlock)(e);for(;n&&"NodeHeading"!==n.getAttribute("data-type");)n=(0,t.getPreviousBlock)(n);return n};t.getPreviousBlock=e=>{let t=e;for(;t;){if(t.previousElementSibling&&t.previousElementSibling.getAttribute("data-node-id"))return t.previousElementSibling;const e=(0,i.hasClosestBlock)(t.parentElement);if(!e)return!1;t=e}};t.getLastBlock=e=>{let t;return Array.from(e.querySelectorAll("[data-node-id]")).reverse().find((e=>{if(!(0,i.hasClosestByAttribute)(e.parentElement,"data-type","NodeBlockQueryEmbed"))return t=e,!0})),t||e};t.getFirstBlock=e=>{let t;return Array.from(e.querySelectorAll("[data-node-id]")).find((e=>{if(!(0,i.hasClosestByAttribute)(e.parentElement,"data-type","NodeBlockQueryEmbed")&&!e.classList.contains("li"))return t=e,!0})),t||e};t.getNextBlock=e=>{let t=e;for(;t;){if(t.nextElementSibling&&!t.nextElementSibling.classList.contains("protyle-attr"))return t.nextElementSibling;const e=(0,i.hasClosestBlock)(t.parentElement);if(!e)return!1;t=e}return!1};t.getNoContainerElement=e=>{let t=e;for(;t;){if(!(t.classList.contains("list")||t.classList.contains("li")||t.classList.contains("bq")||t.classList.contains("sb")))return t;t=t.querySelector("[data-node-id]")}return!1};t.getContenteditableElement=e=>!e||"true"===e.getAttribute("contenteditable")&&!e.classList.contains("protyle-wysiwyg")?e:e.querySelector('[contenteditable="true"]');t.isNotEditBlock=e=>["NodeBlockQueryEmbed","NodeThematicBreak","NodeMathBlock","NodeHTMLBlock","NodeIFrame","NodeWidget","NodeVideo","NodeAudio"].includes(e.getAttribute("data-type"))||"NodeCodeBlock"===e.getAttribute("data-type")&&e.classList.contains("render-node");t.getTopEmptyElement=e=>{var t,n;let i=e;for(;i.parentElement&&!i.parentElement.classList.contains("protyle-wysiwyg");)if(i.parentElement.getAttribute("data-node-id")){let e=!1;if(Array.from(i.parentElement.querySelectorAll('[contenteditable="true"]')).find((t=>{if(""!==t.textContent.replace(a.Constants.ZWSP,"").replace("\n",""))return e=!0,!0})),e||(null===(t=i.previousElementSibling)||void 0===t?void 0:t.getAttribute("data-node-id"))||(null===(n=i.nextElementSibling)||void 0===n?void 0:n.getAttribute("data-node-id")))break;i=i.parentElement}else i=i.parentElement;return i};t.getTopAloneElement=e=>{if("NodeBlockquote"===e.parentElement.getAttribute("data-type")&&2===e.parentElement.childElementCount)for(;!e.parentElement.classList.contains("protyle-wysiwyg");){if("NodeBlockquote"!==e.parentElement.getAttribute("data-type")||2!==e.parentElement.childElementCount){e=(0,t.getTopAloneElement)(e);break}e=e.parentElement}else if("NodeSuperBlock"===e.parentElement.getAttribute("data-type")&&2===e.parentElement.childElementCount)for(;!e.parentElement.classList.contains("protyle-wysiwyg");){if("NodeSuperBlock"!==e.parentElement.getAttribute("data-type")||2!==e.parentElement.childElementCount){e=(0,t.getTopAloneElement)(e);break}e=e.parentElement}else if("NodeListItem"===e.parentElement.getAttribute("data-type")&&3===e.parentElement.childElementCount)for(;!e.parentElement.classList.contains("protyle-wysiwyg");)if("NodeListItem"===e.parentElement.getAttribute("data-type")&&3===e.parentElement.childElementCount)e=e.parentElement;else{if("NodeList"!==e.parentElement.getAttribute("data-type")||2!==e.parentElement.childElementCount){e=(0,t.getTopAloneElement)(e);break}e=e.parentElement}else if("NodeList"===e.parentElement.getAttribute("data-type")&&2===e.parentElement.childElementCount)for(;!e.parentElement.classList.contains("protyle-wysiwyg");)if("NodeList"===e.parentElement.getAttribute("data-type")&&2===e.parentElement.childElementCount)e=e.parentElement;else{if("NodeListItem"!==e.parentElement.getAttribute("data-type")||3!==e.parentElement.childElementCount){e=(0,t.getTopAloneElement)(e);break}e=e.parentElement}return e};t.hasNextSibling=e=>{let t=e.nextSibling;for(;t;){if(""!==t.textContent||3!==t.nodeType)return t;t=t.nextSibling}return!1};t.hasPreviousSibling=e=>{let t=e.previousSibling;for(;t;){if(""!==t.textContent||3!==t.nodeType)return t;t=t.previousSibling}return!1};t.getNextFileLi=e=>{let t=e.nextElementSibling;if(t)return"LI"===t.tagName?t:"UL"===t.tagName&&t.firstElementChild;for(t=e.parentElement;"UL"===t.tagName;)if(t.nextElementSibling){if("LI"===t.nextElementSibling.tagName)return t.nextElementSibling;if("UL"===t.nextElementSibling.tagName)return t.nextElementSibling.firstElementChild}else t=t.parentElement;return!1};t.getPreviousFileLi=e=>{let t=e.previousElementSibling;if(t)return"LI"===t.tagName?t:"UL"===t.tagName&&t.lastElementChild;for(t=e.parentElement;"UL"===t.tagName;)if(t.previousElementSibling){if("LI"===t.previousElementSibling.tagName)return t.previousElementSibling;if("UL"===t.previousElementSibling.tagName){const e=t.previousElementSibling.querySelectorAll(".b3-list-item");return e[e.length-1]}}else t=t.parentElement;return!1}},61:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setMode=t.setCodeTheme=t.setInlineStyle=t.addGA=t.initAssets=t.loadAssets=void 0;const i=n(450),a=n(81),s=n(783),o=n(955),r=n(257),l=(e,t)=>{(0,a.addScript)(e,"iconDefaultScript").then((()=>{if(!["ant","material"].includes(t.icon)){const e=document.getElementById("iconScript");e&&e.remove(),(0,a.addScript)(`/appearance/icons/${t.icon}/icon.js?v=${t.iconVer}`,"iconScript")}}))};t.loadAssets=e=>{const n=document.getElementById("themeDefaultStyle");let o=`/appearance/themes/${1===e.mode?"midnight":"daylight"}/${e.customCSS?"custom":"theme"}.css?v=${e.customCSS?(new Date).getTime():i.Constants.SIYUAN_VERSION}`;(1===e.mode&&"midnight"!==e.themeDark||0===e.mode&&"daylight"!==e.themeLight)&&(o=`/appearance/themes/${1===e.mode?"midnight":"daylight"}/theme.css?v=${i.Constants.SIYUAN_VERSION}`),n?n.getAttribute("href").startsWith(o)||(n.remove(),(0,s.addStyle)(o,"themeDefaultStyle")):(0,s.addStyle)(o,"themeDefaultStyle");const r=document.getElementById("themeStyle");if(1===e.mode&&"midnight"!==e.themeDark||0===e.mode&&"daylight"!==e.themeLight){const t=`/appearance/themes/${1===e.mode?e.themeDark:e.themeLight}/${e.customCSS?"custom":"theme"}.css?v=${e.customCSS?(new Date).getTime():e.themeVer}`;r?r.getAttribute("href").startsWith(t)||(r.remove(),(0,s.addStyle)(t,"themeStyle")):(0,s.addStyle)(t,"themeStyle")}else r&&r.remove();(0,t.setCodeTheme)();const d=document.getElementById("themeScript"),c=`/appearance/themes/${1===e.mode?e.themeDark:e.themeLight}/theme.js?v=${e.themeVer}`;d?d.getAttribute("src").startsWith(c)||(d.remove(),(0,a.addScript)(c,"themeScript")):(0,a.addScript)(c,"themeScript");const u=document.getElementById("iconDefaultScript"),g=`/appearance/icons/${["ant","material"].includes(e.icon)?e.icon:"material"}/icon.js?v=${i.Constants.SIYUAN_VERSION}`;if(u){u.remove();let t=document.body.firstElementChild;for(;"svg"===t.tagName;){const e=t;t=t.nextElementSibling,"emojiScriptSvg"!==e.id&&e.remove()}l(g,e)}else l(g,e)};t.initAssets=()=>{const e=document.getElementById("emojiScript"),t=document.getElementById("loading");e||window.siyuan.config.appearance.nativeEmoji||(0,o.isMobile)()?t&&setTimeout((()=>{t.remove()}),160):(0,a.addScript)("/appearance/emojis/twitter-emoji.js?v=1.0.1","emojiScript").then((()=>{t&&t.remove()})),d({init:!0,OSTheme:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{d({init:!1,OSTheme:e.matches?"dark":"light"})}))};t.addGA=()=>{if(!window.siyuan.config.system.disableGoogleAnalytics){(0,a.addScript)("https://www.googletagmanager.com/gtag/js?id=G-L7WEXVQCR9","gaScript"),window.dataLayer=window.dataLayer||[];const e=function(...e){window.dataLayer.push(arguments)};e("js",new Date),e("config","G-L7WEXVQCR9",{send_page_view:!1});const t={version:i.Constants.SIYUAN_VERSION,container:window.siyuan.config.system.container,os:window.siyuan.config.system.os,isLoggedIn:!1,subscriptionStatus:-1,subscriptionPlan:-1,subscriptionType:-1,syncEnabled:!1,syncProvider:-1,cTreeCount:window.siyuan.config.stat.cTreeCount,cBlockCount:window.siyuan.config.stat.cBlockCount,cDataSize:window.siyuan.config.stat.cDataSize,cAssetsSize:window.siyuan.config.stat.cAssetsSize};window.siyuan.user&&(t.isLoggedIn=!0,t.subscriptionStatus=window.siyuan.user.userSiYuanSubscriptionStatus,t.subscriptionPlan=window.siyuan.user.userSiYuanSubscriptionPlan,t.subscriptionType=window.siyuan.user.userSiYuanSubscriptionType),window.siyuan.config.sync&&(t.syncEnabled=window.siyuan.config.sync.enabled,t.syncProvider=window.siyuan.config.sync.provider),e("event",i.Constants.ANALYTICS_EVT_ON_GET_CONFIG,t)}};t.setInlineStyle=(e=!0)=>{const t=Math.floor(1.625*window.siyuan.config.editor.fontSize);let n=`.b3-typography, .protyle-wysiwyg, .protyle-title {font-size:${window.siyuan.config.editor.fontSize}px !important}\n.b3-typography code:not(.hljs), .protyle-wysiwyg span[data-type~=code] { font-variant-ligatures: ${window.siyuan.config.editor.codeLigatures?"normal":"none"} }\n.li > .protyle-action {height:${t+8}px;line-height: ${t+8}px}\n.protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h1, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h2, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h3, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h4, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h5, .protyle-wysiwyg [data-node-id].li > .protyle-action ~ .h6 {line-height:${t+8}px;}\n.protyle-wysiwyg [data-node-id].li > .protyle-action:after {height: ${window.siyuan.config.editor.fontSize}px;width: ${window.siyuan.config.editor.fontSize}px;margin:-${window.siyuan.config.editor.fontSize/2}px 0 0 -${window.siyuan.config.editor.fontSize/2}px}\n.protyle-wysiwyg [data-node-id].li > .protyle-action svg {height: ${Math.max(14,window.siyuan.config.editor.fontSize-8)}px}\n.protyle-wysiwyg [data-node-id] [spellcheck="false"] {min-height:${t}px;}\n.protyle-wysiwyg [data-node-id] {${window.siyuan.config.editor.rtl?" direction: rtl;":""}${window.siyuan.config.editor.justify?" text-align: justify;":""}}\n.protyle-wysiwyg .li {min-height:${t+8}px}\n.protyle-gutters button svg {height:${t}px}\n.protyle-wysiwyg img.emoji, .b3-typography img.emoji {width:${t-8}px}\n.protyle-wysiwyg .h1 img.emoji, .b3-typography h1 img.emoji {width:${Math.floor(1.75*window.siyuan.config.editor.fontSize*1.25)}px}\n.protyle-wysiwyg .h2 img.emoji, .b3-typography h2 img.emoji {width:${Math.floor(1.55*window.siyuan.config.editor.fontSize*1.25)}px}\n.protyle-wysiwyg .h3 img.emoji, .b3-typography h3 img.emoji {width:${Math.floor(1.38*window.siyuan.config.editor.fontSize*1.25)}px}\n.protyle-wysiwyg .h4 img.emoji, .b3-typography h4 img.emoji {width:${Math.floor(1.25*window.siyuan.config.editor.fontSize*1.25)}px}\n.protyle-wysiwyg .h5 img.emoji, .b3-typography h5 img.emoji {width:${Math.floor(1.13*window.siyuan.config.editor.fontSize*1.25)}px}\n.protyle-wysiwyg .h6 img.emoji, .b3-typography h6 img.emoji {width:${Math.floor(1.25*window.siyuan.config.editor.fontSize)}px}`;return window.siyuan.config.editor.fontFamily&&(n+=`.b3-typography:not(.b3-typography--default), .protyle-wysiwyg, .protyle-title, .protyle-title__input{font-family: "${window.siyuan.config.editor.fontFamily}", "quote", "Helvetica Neue", "Luxi Sans", "DejaVu Sans", "Hiragino Sans GB", "Microsoft Yahei", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", "Segoe UI Symbol", "Android Emoji", "EmojiSymbols" !important;}`),e&&(document.getElementById("editorFontSize").innerHTML=n),n};t.setCodeTheme=(e=i.Constants.PROTYLE_CDN)=>{const t=document.getElementById("protyleHljsStyle");let n;0===window.siyuan.config.appearance.mode?(n=window.siyuan.config.appearance.codeBlockThemeLight,i.Constants.SIYUAN_CONFIG_APPEARANCE_LIGHT_CODE.includes(n)||(n="default")):(n=window.siyuan.config.appearance.codeBlockThemeDark,i.Constants.SIYUAN_CONFIG_APPEARANCE_DARK_CODE.includes(n)||(n="github-dark"));const a=`${e}/js/highlight.js/styles/${n}.min.css?v=11.5.0`;t?t.href.includes(a)||(t.remove(),(0,s.addStyle)(a,"protyleHljsStyle")):(0,s.addStyle)(a,"protyleHljsStyle")};t.setMode=e=>{};const d=e=>{var n;("ios"===window.siyuan.config.system.container&&(null===(n=window.webkit)||void 0===n?void 0:n.messageHandlers)||"android"===window.siyuan.config.system.container&&window.JSAndroid)&&setTimeout((()=>{var t;const n=getComputedStyle(document.body).getPropertyValue("--b3-theme-background");let i=window.siyuan.config.appearance.mode;window.siyuan.config.appearance.modeOS&&(i="dark"===e.OSTheme?1:0),"ios"===window.siyuan.config.system.container&&(null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers)?window.webkit.messageHandlers.changeStatusBar.postMessage(n+" "+i):"android"===window.siyuan.config.system.container&&window.JSAndroid&&window.JSAndroid.changeStatusBarColor(n,i)}),500),e.init?window.siyuan.config.appearance.modeOS&&(1===window.siyuan.config.appearance.mode&&"light"===e.OSTheme||0===window.siyuan.config.appearance.mode&&"dark"===e.OSTheme)?(0,r.fetchPost)("/api/system/setAppearanceMode",{mode:"light"===e.OSTheme?0:1},(e=>{window.siyuan.config.appearance=e.data.appearance,(0,t.loadAssets)(e.data.appearance)})):(0,t.loadAssets)(window.siyuan.config.appearance):window.siyuan.config.appearance.modeOS&&(0===window.siyuan.config.appearance.mode&&"light"===e.OSTheme||1===window.siyuan.config.appearance.mode&&"dark"===e.OSTheme||(0,r.fetchPost)("/api/system/setAppearanceMode",{mode:"light"===e.OSTheme?0:1},(e=>{window.siyuan.config.appearance.themeJS?window.location.reload():(window.siyuan.config.appearance=e.data.appearance,(0,t.loadAssets)(e.data.appearance))})))}},257:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function r(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchGet=t.fetchSyncPost=t.fetchPost=void 0;const a=n(180),s=n(393);t.fetchPost=(e,t,n,i)=>{const o={method:"POST"};t&&(["/api/search/searchRefBlock","/api/graph/getGraph","/api/graph/getLocalGraph"].includes(e)&&(window.siyuan.reqIds[e]=(new Date).getTime(),"local"===t.type&&"/api/graph/getLocalGraph"===e||(t.reqId=window.siyuan.reqIds[e])),t instanceof FormData?o.body=t:o.body=JSON.stringify(t)),i&&(o.headers=i),fetch(e,o).then((e=>e.json())).then((t=>{["/api/search/searchRefBlock","/api/graph/getGraph","/api/graph/getLocalGraph"].includes(e)&&t.data.reqId&&window.siyuan.reqIds[e]&&window.siyuan.reqIds[e]>t.data.reqId||(0,a.processMessage)(t)&&n&&n(t)})).catch((t=>{console.warn("fetch post error",t),"/api/transactions"!==e||"Failed to fetch"!==t.message&&"Unexpected end of JSON input"!==t.message||(0,s.kernelError)()}))};t.fetchSyncPost=(e,t)=>i(void 0,void 0,void 0,(function*(){const n={method:"POST"};t&&(n.body=JSON.stringify(t));const i=yield fetch(e,n),s=yield i.json();return(0,a.processMessage)(s),s}));t.fetchGet=(e,t)=>{fetch(e).then((e=>e.json())).then((e=>{t(e)}))}},955:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isFileAnnotation=t.isDynamicRef=t.isBrowser=t.getSearch=t.getRandom=t.isArrayEqual=t.isTouchDevice=t.isMobile=void 0;t.isMobile=()=>!document.getElementById("dockBottom");t.isTouchDevice=()=>"ontouchstart"in window&&navigator.maxTouchPoints>1;t.isArrayEqual=(e,t)=>e.length===t.length&&e.every((e=>t.includes(e)));t.getRandom=(e,t)=>Math.floor(Math.random()*(t-e+1))+e;t.getSearch=(e,t=window.location.search)=>{if(-1===t.indexOf("?"))return"";let n="";return t.split("?")[1].split("&").find((t=>{const i=t.split("=");if(i[0]===e)return n=i[1],!0})),n};t.isBrowser=()=>!0;t.isDynamicRef=e=>/^\(\(\d{14}-\w{7} '.*'\)\)$/.test(e);t.isFileAnnotation=e=>/^<<assets\/.+\/\d{14}-\w{7} ".+">>$/.test(e)},628:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.genUUID=void 0;t.genUUID=()=>([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(parseInt(e,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(e,10)/4).toString(16)))},180:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processMessage=void 0;const i=n(751);t.processMessage=e=>{if("msg"===e.cmd)return(0,i.showMessage)(e.msg,e.data.closeTimeout,0===e.code?"info":"error",e.data.id),!1;if("cmsg"===e.cmd)return(0,i.hideMessage)(e.data.id),!1;if("cprogress"===e.cmd){const e=document.getElementById("progress");return e&&e.remove(),!1}return"reloadui"===e.cmd?(window.location.reload(),!1):e.code<0?((0,i.showMessage)(e.msg,e.data&&e.data.closeTimeout||0,-1===e.code?"error":"info"),!1):e}}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{var e=i;const t=n(364),a=n(631),s=n(430),o=n(608),r=n(509),l=n(475),d=n(163),c=n(938),u=n(696);n(378);class g{}g.graphvizRender=t.graphvizRender,g.highlightRender=a.highlightRender,g.mathRender=s.mathRender,g.mermaidRender=o.mermaidRender,g.flowchartRender=r.flowchartRender,g.chartRender=l.chartRender,g.abcRender=d.abcRender,g.mindmapRender=c.mindmapRender,g.plantumlRender=u.plantumlRender,e.default=g})(),i=i.default})()));